+ trap 'cat /sys/fs/cgroup/memory/$(cat /proc/$$/cgroup | grep -oP '\''^.*:memory:\K.*$'\'')/memory.max_usage_in_bytes > /import/ch-sc-swdump2/surajk/artifact_root/apps/ch__jit_backward_pipeline_directives/run/max_used_host_memory.0 && grep --text -oP "slurmJobId=$SLURM_JOB_ID.*Physical RDU ID: \K\d+" /var/log/sambaflow/runtime/sn.log > /import/ch-sc-swdump2/surajk/artifact_root/apps/ch__jit_backward_pipeline_directives/run/physical_chip_ids.0 || true' EXIT
+ cd /import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/frontend/jit/torch_rdu/test/python/
+ ulimit -l unlimited
+ mkdir -p /scratch/surajk/.cache/huggingface
+ export PATH=/usr/local/bin:/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin
+ PATH=/usr/local/bin:/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin
+ export PYTHONPATH=/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/venv/lib/python3.7/site-packages:/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/sambaflow:/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/frontend/jit/torch_rdu/test/python/
+ PYTHONPATH=/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/venv/lib/python3.7/site-packages:/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/sambaflow:/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/frontend/jit/torch_rdu/test/python/
+ export LD_LIBRARY_PATH=/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/lib:/opt/llvm12/lib:
+ LD_LIBRARY_PATH=/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p/lib:/opt/llvm12/lib:
+ export SOFTWARE_HOME=/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p
+ SOFTWARE_HOME=/import/ch-sc-swdump2/surajk/sambaflow_PIaWV9hw0p
+ export ARTIFACT_ROOT=/import/ch-sc-swdump2/surajk/artifact_root
+ ARTIFACT_ROOT=/import/ch-sc-swdump2/surajk/artifact_root
+ true
+ OMP_NUM_THREADS=8
+ python experiments/backward_pipeline_directives.py
[compiler:info] [torch_rdu] empty_strided ...
[compiler:info] [torch_rdu] empty for size: {2, 64, 32} ...
[compiler:info] [torch_rdu] Copy from: 0x55fc88f7c900 to: 0x55fc87f66c80
[compiler:info]   Source: 16384 bytes with name  0x0
[compiler:info]   Dest: 16384 bytes with name  0x0
[compiler:info] [torch_rdu] empty_strided ...
[compiler:info] [torch_rdu] empty for size: {2, 64, 32} ...
[compiler:info] [torch_rdu] Copy from: 0x55fc892ba370 to: 0x55fc892d0ec0
[compiler:info]   Source: 16384 bytes with name  0x0
[compiler:info]   Dest: 16384 bytes with name  0x0
[compiler:info] [torch_rdu] empty_strided ...
[compiler:info] [torch_rdu] empty for size: {2, 64, 32} ...
[compiler:info] [torch_rdu] Copy from: 0x55fc892cef50 to: 0x55fc892d1090
[compiler:info]   Source: 16384 bytes with name  0x0
[compiler:info]   Dest: 16384 bytes with name  0x0
[compiler:info] [torch_rdu] mul ...
[compiler:info] platform name...
[compiler:info] DataScale SN10-8
Log ID initialized to: [surajk][python][615705] at /var/log/sambaflow/runtime/sn.log
[JITPerf] JIT::construct 9775159 ns
[JITPerf] &JIT::construct 9786849 ns
[JITPerf] get_empty() 260 ns
[compiler:info] [torch_rdu] empty for size: {} ...
[JITPerf] get_rdu_tensor_impl() 80 ns
[compiler:info] Creating new IR...
[compiler:info] [torch_rdu] alias ...
[compiler:info] RDU shallow_copy_and_detach &&1 0x55fc87f66c80 1 has_backanno: 0
[compiler:info] [torch_rdu] alias ...
[compiler:info] RDU shallow_copy_and_detach &&1 0x55fc892d0ec0 1 has_backanno: 0
[JITPerf] extract_inputs_helper() 1166816 ns
[JITPerf] &JIT::construct 90 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] &JIT::construct 49 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] &JIT::construct 50 ns
[JITPerf] &JIT::construct 50 ns
[JITPerf] get_rdu_tensor_impl() 290 ns
[JITPerf] update_ir() 2360 ns
[compiler:info] module @program attributes {arc.AIRMappingDecisionIsSpatial = false, arc.kAIRAddnOpt = true, arc.kAIRBufferBeforeConcatAddn = false, arc.kAIRBufferNonRedundancy = "", arc.kAIRDPTilingOptimization = false, arc.kAIRDisableConcatStoreOpt = false, arc.kAIRDisableLoadTilerOptWithDimOrdering = false, arc.kAIRDisableOptimizeRereadBuffer = false, arc.kAIREnableSkipBufferExtensionOpt = false, arc.kAIREnableStoreTilerOptWithDimOrdering = false, arc.kAIRForceDRAMFirstThenP2P = false, arc.kAIRMappingDecisionGlobalNumBatches = 1 : i64, arc.kAIRMetaPipeWithOneIterationRemoval = false, arc.kAIRTransposeMatMulTransformation = false, arc.kAppName = "jit_out", arc.kArchMajor = 1 : i64, arc.kArchMinor = 0 : i64, arc.kBoxLayoutSize = 2 : i64, arc.kBoxLayoutType = 0 : i64, arc.kConcisePrinting = false, arc.kDataParallelBf16StochasticRounding = false, arc.kDataParallelBf16StochasticRoundingHighStaticBatchSize = false, arc.kDataParallelBf16StochasticRoundingSeedName = "", arc.kEliminateBufferTimeout = 100 : i64, arc.kExperimentalOptimization = true, arc.kExperimentalRAILCrossEntropy = false, arc.kExperimentalRAILCrossEntropyGrad = false, arc.kGenerateReference = true, arc.kGenerateTensorboard = false, arc.kHeuristicSliceLayouts = false, arc.kHeuristicTilerLayouts = true, arc.kLayoutTimeout = 1000 : i64, arc.kLegalizeDataflow = true, arc.kLegalizeSamples = false, arc.kMaximumGroupLatencyFactor = 5.000000e-02 : f32, arc.kMoveViews = false, arc.kOptimizeDramTransfers = false, arc.kOutputFolder = "/scratch/jobs/38941838", arc.kOverrideMaxFanout = 0 : i64, arc.kPefName = "jit_out", arc.kPlasmaIncludeReadStallCycles = false, arc.kPlasmaSkipInstrumentationOnRead0 = false, arc.kPlasmaSkipInstrumentationOnRead1 = false, arc.kPlasmaStageInstrumentation = "none", arc.kPrintSrcs = [], arc.kResourceAwareBuffers = false, arc.kSambaTuneGraph = false, arc.kSkipBufferBandwidthWeight = 1 : i64, arc.kSkipBufferMaxDepth = 4096 : i64, arc.kSkipBufferMaxFanin = 8 : i64, arc.kSkipBufferPmuWeight = 1 : i64, arc.kSplitSkipBuffer = true, arc.kStrictNodeNameOrdering = true, arc.kUseTBufferEverywhere = false, arc.kVerbose = true, mac.kDisableMacTiling = false, mac.kMacDisableMappingSort = false, mac.kMacDisableRetryLowerScalingFactor = false, mac.kMacEnableBufferTrialCompile = false, mac.kMacEnableHDRetryLowerVisibleResources = false, mac.kMacEnableNodeTrialCompile = false, mac.kMacEnableNodeTrialCompileLogging = false, mac.kMacIsUnrollingFirst = false, mac.kMacMaxTilingDepth = 0 : i64, mac.kMacOnlyCompileMac = false, mac.kMacPlot = false, mac.kMacPrintMappingIR = false, mac.kMacSectionCutBeamSearch = [2, 2], mac.kMacSplitCatAsStageBuffer = false, mac.kMacTemplateDBDir = "", mac.kMacTensorParallel = "none", mac.kMacUseHostFIFO = false}  {
  module @templates  {
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 1 : i64} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 1 : i64} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 1 : i64, sym_name = "mul_lambda1", type = () -> ()} : () -> ()
  }
  module @sections  {
    %0 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %1 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %2 = "air.Collect"(%0, %1) {kConfigured = true, kLambda = @mul_lambda1, kMacInfoName = "collect_default", kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
  }
  module @schedule  {
  }
  module @rnn_function  {
  }
}
[JITPerf] apply_binary_() 1468018 ns
[JITPerf] apply_binary() 1480808 ns
[compiler:info] [torch_rdu] log ...
[JITPerf] &JIT::construct 80 ns
[JITPerf] get_empty() 160 ns
[compiler:info] [torch_rdu] empty for size: {} ...
[JITPerf] get_rdu_tensor_impl() 60 ns
[JITPerf] extract_inputs_helper() 1470 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] get_rdu_tensor_impl() 70 ns
[JITPerf] update_ir() 1050 ns
[compiler:info] module @program attributes {arc.AIRMappingDecisionIsSpatial = false, arc.kAIRAddnOpt = true, arc.kAIRBufferBeforeConcatAddn = false, arc.kAIRBufferNonRedundancy = "", arc.kAIRDPTilingOptimization = false, arc.kAIRDisableConcatStoreOpt = false, arc.kAIRDisableLoadTilerOptWithDimOrdering = false, arc.kAIRDisableOptimizeRereadBuffer = false, arc.kAIREnableSkipBufferExtensionOpt = false, arc.kAIREnableStoreTilerOptWithDimOrdering = false, arc.kAIRForceDRAMFirstThenP2P = false, arc.kAIRMappingDecisionGlobalNumBatches = 1 : i64, arc.kAIRMetaPipeWithOneIterationRemoval = false, arc.kAIRTransposeMatMulTransformation = false, arc.kAppName = "jit_out", arc.kArchMajor = 1 : i64, arc.kArchMinor = 0 : i64, arc.kBoxLayoutSize = 2 : i64, arc.kBoxLayoutType = 0 : i64, arc.kConcisePrinting = false, arc.kDataParallelBf16StochasticRounding = false, arc.kDataParallelBf16StochasticRoundingHighStaticBatchSize = false, arc.kDataParallelBf16StochasticRoundingSeedName = "", arc.kEliminateBufferTimeout = 100 : i64, arc.kExperimentalOptimization = true, arc.kExperimentalRAILCrossEntropy = false, arc.kExperimentalRAILCrossEntropyGrad = false, arc.kGenerateReference = true, arc.kGenerateTensorboard = false, arc.kHeuristicSliceLayouts = false, arc.kHeuristicTilerLayouts = true, arc.kLayoutTimeout = 1000 : i64, arc.kLegalizeDataflow = true, arc.kLegalizeSamples = false, arc.kMaximumGroupLatencyFactor = 5.000000e-02 : f32, arc.kMoveViews = false, arc.kOptimizeDramTransfers = false, arc.kOutputFolder = "/scratch/jobs/38941838", arc.kOverrideMaxFanout = 0 : i64, arc.kPefName = "jit_out", arc.kPlasmaIncludeReadStallCycles = false, arc.kPlasmaSkipInstrumentationOnRead0 = false, arc.kPlasmaSkipInstrumentationOnRead1 = false, arc.kPlasmaStageInstrumentation = "none", arc.kPrintSrcs = [], arc.kResourceAwareBuffers = false, arc.kSambaTuneGraph = false, arc.kSkipBufferBandwidthWeight = 1 : i64, arc.kSkipBufferMaxDepth = 4096 : i64, arc.kSkipBufferMaxFanin = 8 : i64, arc.kSkipBufferPmuWeight = 1 : i64, arc.kSplitSkipBuffer = true, arc.kStrictNodeNameOrdering = true, arc.kUseTBufferEverywhere = false, arc.kVerbose = true, mac.kDisableMacTiling = false, mac.kMacDisableMappingSort = false, mac.kMacDisableRetryLowerScalingFactor = false, mac.kMacEnableBufferTrialCompile = false, mac.kMacEnableHDRetryLowerVisibleResources = false, mac.kMacEnableNodeTrialCompile = false, mac.kMacEnableNodeTrialCompileLogging = false, mac.kMacIsUnrollingFirst = false, mac.kMacMaxTilingDepth = 0 : i64, mac.kMacOnlyCompileMac = false, mac.kMacPlot = false, mac.kMacPrintMappingIR = false, mac.kMacSectionCutBeamSearch = [2, 2], mac.kMacSplitCatAsStageBuffer = false, mac.kMacTemplateDBDir = "", mac.kMacTensorParallel = "none", mac.kMacUseHostFIFO = false}  {
  module @templates  {
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 1 : i64} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 1 : i64} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 1 : i64, sym_name = "mul_lambda1", type = () -> ()} : () -> ()
  }
  module @sections  {
    %0 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %1 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %2 = "air.Collect"(%0, %1) {kConfigured = true, kLambda = @mul_lambda1, kMacInfoName = "collect_default", kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    %3 = "air.Log"(%2) {kConfigured = true, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
  }
  module @schedule  {
  }
  module @rnn_function  {
  }
}
[JITPerf] apply_unary() 110890 ns
[JITPerf] apply_unary_out() 119090 ns
[compiler:info] ++ BACKWARD ANNOTATION SIZE 0
[compiler:info] [annotate] backward edge function: MulBackward0
[JITPerf] &JIT::construct 90 ns
[JITPerf] force_evaluate::RDUTensorImpl 300 ns
[compiler:info] Forcing evaluation...
[compiler:info] owning_ir_storage count: 2
[JITPerf] force_evaluate::PrepareIR 48250 ns
[compiler:info] module @program attributes {arc.AIRMappingDecisionIsSpatial = false, arc.kAIRAddnOpt = true, arc.kAIRBufferBeforeConcatAddn = false, arc.kAIRBufferNonRedundancy = "", arc.kAIRDPTilingOptimization = false, arc.kAIRDisableConcatStoreOpt = false, arc.kAIRDisableLoadTilerOptWithDimOrdering = false, arc.kAIRDisableOptimizeRereadBuffer = false, arc.kAIREnableSkipBufferExtensionOpt = false, arc.kAIREnableStoreTilerOptWithDimOrdering = false, arc.kAIRForceDRAMFirstThenP2P = false, arc.kAIRMappingDecisionGlobalNumBatches = 1 : i64, arc.kAIRMetaPipeWithOneIterationRemoval = false, arc.kAIRTransposeMatMulTransformation = false, arc.kAppName = "jit_out", arc.kArchMajor = 1 : i64, arc.kArchMinor = 0 : i64, arc.kBoxLayoutSize = 2 : i64, arc.kBoxLayoutType = 0 : i64, arc.kConcisePrinting = false, arc.kDataParallelBf16StochasticRounding = false, arc.kDataParallelBf16StochasticRoundingHighStaticBatchSize = false, arc.kDataParallelBf16StochasticRoundingSeedName = "", arc.kEliminateBufferTimeout = 100 : i64, arc.kExperimentalOptimization = true, arc.kExperimentalRAILCrossEntropy = false, arc.kExperimentalRAILCrossEntropyGrad = false, arc.kGenerateReference = true, arc.kGenerateTensorboard = false, arc.kHeuristicSliceLayouts = false, arc.kHeuristicTilerLayouts = true, arc.kLayoutTimeout = 1000 : i64, arc.kLegalizeDataflow = true, arc.kLegalizeSamples = false, arc.kMaximumGroupLatencyFactor = 5.000000e-02 : f32, arc.kMoveViews = false, arc.kOptimizeDramTransfers = false, arc.kOutputFolder = "/scratch/jobs/38941838", arc.kOverrideMaxFanout = 0 : i64, arc.kPefName = "jit_out", arc.kPlasmaIncludeReadStallCycles = false, arc.kPlasmaSkipInstrumentationOnRead0 = false, arc.kPlasmaSkipInstrumentationOnRead1 = false, arc.kPlasmaStageInstrumentation = "none", arc.kPrintSrcs = [], arc.kResourceAwareBuffers = false, arc.kSambaTuneGraph = false, arc.kSkipBufferBandwidthWeight = 1 : i64, arc.kSkipBufferMaxDepth = 4096 : i64, arc.kSkipBufferMaxFanin = 8 : i64, arc.kSkipBufferPmuWeight = 1 : i64, arc.kSplitSkipBuffer = true, arc.kStrictNodeNameOrdering = true, arc.kUseTBufferEverywhere = false, arc.kVerbose = true, mac.kDisableMacTiling = false, mac.kMacDisableMappingSort = false, mac.kMacDisableRetryLowerScalingFactor = false, mac.kMacEnableBufferTrialCompile = false, mac.kMacEnableHDRetryLowerVisibleResources = false, mac.kMacEnableNodeTrialCompile = false, mac.kMacEnableNodeTrialCompileLogging = false, mac.kMacIsUnrollingFirst = false, mac.kMacMaxTilingDepth = 0 : i64, mac.kMacOnlyCompileMac = false, mac.kMacPlot = false, mac.kMacPrintMappingIR = false, mac.kMacSectionCutBeamSearch = [2, 2], mac.kMacSplitCatAsStageBuffer = false, mac.kMacTemplateDBDir = "", mac.kMacTensorParallel = "none", mac.kMacUseHostFIFO = false}  {
  module @templates  {
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 1 : i64} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 1 : i64} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 1 : i64, sym_name = "mul_lambda1", type = () -> ()} : () -> ()
  }
  module @sections  {
    %0 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %1 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %2 = "air.Collect"(%0, %1) {kConfigured = true, kLambda = @mul_lambda1, kMacInfoName = "collect_default", kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    %3 = "air.Log"(%2) {kConfigured = true, kNodeCategory = 1 : i64} : (tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    "air.Output"(%2) {kConfigured = true, kNodeCategory = 5 : i64} : (tensor<2x64x32xbf16>) -> ()
    "air.Output"(%3) {kConfigured = true, kNodeCategory = 5 : i64} : (tensor<2x64x32xbf16>) -> ()
  }
  module @schedule  {
  }
  module @rnn_function  {
  }
}
[JITPerf] force_evaluate::PopulateMeta 103260 ns
[compiler:info] ====== HASH INFO: e3cb9d4a658dcc1630059ef2cf7e11e67865e25a57edc2c722948ee0bb2fdd8c
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
MAC050_AIRResourceAwarePeepholeOptIter converged after 1 iteration(s)
MAC055_AIRToTLIRLoweringNestedLoopsIter converged after 0 iteration(s)
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
[info    ] [PLASMA] Launching plasma compilation! See log file: /scratch/jobs/38941838/jit_out/jit_out.plasma_compile.log
[info    ] Total per-section passes: 77
[info    ] Compiling graph for section 0
[mac:info] Building nameddims for graph jit_out
[mac:info] Analyze tiling for graph: jit_out
[mac:info] Mapping for graph jit_out
[mac:info] Set up stage ID and metapipe ID for section 0
[mac:info] MAC decided on the following section cuts for graph jit_out
[mac:info] Amortized resources overall: 2.000000e+00 PCUs, 1.100000e+01 PMUs, projected latency: 3.530618e-05 s, FLOPS: 2.320274e-04 T/s, DDR_BW: 8.643694e-01 GB/s
[mac:info] Lowering to TLIR succeeded.
[rail:info] Logs are generated in /scratch/jobs/38941838/jit_out//rail_gen//rail_compile_logs for partition_0_0_.
[rail:info] Compilation succeeded for partition_0_0_. Elapsed time:  126ms
[info    ] [PASS] Running PRISM000_PreProcessPass0_0
[info    ] Generated utilization report file: /scratch/jobs/38941838/jit_out/jit_out.s0.utilization_report.txt
[info    ] [PASS] Running PRISM001_FeedbackGenPass0_0
[info    ] [PASS] Running PRISM002_PlasmaIRPass0_0
[compiler:info] Starting Plasma compile at /scratch/jobs/38941838/jit_out/plasma_ir_modules/sections_0_0
[compiler:info] Plasma compile succeeded.
[compiler:info] Starting Plasma compile at /scratch/jobs/38941838/jit_out/plasma_ir_modules/schedule_0_0
[compiler:info] Plasma compile succeeded.
[info    ] [PASS] Running PRISM003_PlasmaIRSymbolAllocExportPass0_0
[info    ] [PASS] Running PRISM004_LegalizeUtilizationPass0_0
[info    ] [PASS] Running PRISM005_LegalizeSocketConnectionsPass0_0
[info    ] [PASS] Running PRISM006_LayoutConsolidationPass0_0
[info    ] [PASS] Running PRISM007_PmuLoadStoreSetupPass0_0
[info    ] [PASS] Running PRISM008_FinalizeIoPass0_0
[info    ] [PASS] Running PRISM009_CollectConnectionPass0_0
[info    ] [PASS] Running PRISM010_NetworkValidationPass0_0
[info    ] [PASS] Running PRISM011_DramAnalyticalReportPass0_0
[info    ] Logging dram analysis report to /scratch/jobs/38941838/jit_out/prism_gen/reports/dram_analysis.json
[info    ] [PASS] Running PRISM012_AsmIRGenPNRConnectPass0_0
[info    ] [PASS] Running PRISM013_PrintLoweringPass0_0
[info    ] [PASS] Running PRISM014_AsmIRResourceAllocationPass0_0
[info    ] [PASS] Running PRISM015_PmuExprCompilePass0_0
[info    ] [PASS] Running PRISM016_GroupAnnotationPass0_0
[info    ] [PASS] Running PRISM017_TemplateDataflowGraphPass0_0
[info    ] [PASS] Running PRISM018_BoxUtilizationLegalizerPass0_0
[info    ] [PASS] Running PRISM019_LegalizePartitionAssignmentPass0_0
[info    ] [PASS] Running PRISM020_ConditionValidationPass0_0
[info    ] [PASS] Running PRISM021_AssignMetapipeStagePass0_0
[info    ] [PASS] Running PRISM022_AnalyticalModelFileGenPass0_0
[info    ] [PASS] Running PRISM023_PlasmaIRProgramStatePass0_0
[info    ] [PASS] Running PRISM024_MetapipeStageLatencyPass0_0
[info    ] Generated metapipe stage graph dot file: /scratch/jobs/38941838/jit_out/stage_buffers/partition_latency_0_0.dot
[info    ] [PASS] Running PRISM025_MetapipeStageGraphPass0_0
[info    ] [PASS] Running PRISM026_BandwidthAnnotationPass0_0
[info    ] BandwidthAnnotationPropagation log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM026_BandwidthAnnotationPass0_0.BWP.0.0.log
[info    ] BandwidthAnnotationPropagation log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM026_BandwidthAnnotationPass0_0.BWP.0.0.log
[info    ] 

============ Bandwidth QA Report ============

Total edges: 12
Bandwidth starving edges before pass (src/sink < 0.8): 5 (41.6667%)
Bandwidth back pressure edges before pass (src/sink > 1.2): 2 (16.6667%)
Missing source bandwidth after pass: 0 (0%)
Missing sink bandwidth after pass: 0 (0%)

[info    ] [PASS] Running PRISM027_FilePlacementPass_GenEdgeId0_0
[info    ] [PASS] Running PRISM028_FloorplanPass0_0
[info    ] Floorplanning log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM028_FloorplanPass0_0.FP.0.0.log
[info    ] [PASS] Running PRISM029_VagAllocPass0_0
[info    ] [PASS] Running PRISM030_AsmIRPrePortAllocAsmTransformPass0_0
[info    ] [PASS MANAGER] Start PnR
[info    ] [PASS] Running PRISM031_PlacerPass0_0
[info    ] Prism config stored in: /scratch/jobs/38941838/jit_out/jit_out.configs
[info    ] Launching placement flow with (set) 1 threads
[info    ] BoxPlanner log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM031_PlacerPass0_0.BP.0.0.log
[info    ] WavefrontPlacer log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM031_PlacerPass0_0.DFG.0.0.log
[info    ] SAPlacer log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM031_PlacerPass0_0.SA.0.0.log
[info    ] Placement runtime:	partition{0, 0}: 0s	
[info    ] [PASS] Running PRISM032_PmuTwinPass0_0
[info    ] [PASS] Running PRISM033_TemplateTileDoneLoweringPass0_0
[info    ] [PASS] Running PRISM034_VagConfigurePass0_0
[info    ] [PASS] Running PRISM035_VagAllocReportPass0_0
[info    ] [PASS] Running PRISM036_DataPortAllocatorPass0_0
[info    ] [PASS] Running PRISM037_AgcuOrchestrationPass0_0
[info    ] [PASS] Running PRISM038_RampControlPass0_0
[info    ] [PASS] Running PRISM039_E2EInjectionPass0_0
[info    ] [PASS] Running PRISM040_InstrumentationPreprocessPass0_0
[info    ] [PASS] Running PRISM041_BarrierLoweringPass0_0
[info    ] [PASS] Running PRISM042_ControlPortAllocatorPass0_0
[info    ] [PASS] Running PRISM043_ControlBandwidthAnnotationPass0_0
[info    ] [PASS] Running PRISM044_InstrumentationCounterPass0_0
[info    ] [PASS] Running PRISM045_ControlPortAllocatorPass0_0
[info    ] [PASS] Running PRISM046_ControlConnectorPass0_0
[info    ] [PASS] Running PRISM047_DataConnectorPass0_0
[info    ] [PASS MANAGER] Done with PnR
[info    ] [PASS] Running PRISM048_BandwidthReportPass0_0
[info    ] BandwidthReport log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM048_BandwidthReportPass0_0.VECTOR.0.0.log
[info    ] BandwidthReport log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM048_BandwidthReportPass0_0.SCALAR.0.0.log
[info    ] [PASS] Running PRISM049_FeedbackGenPass0_0
[info    ] [PASS] Running PRISM050_ControlConnectionCodegenPass0_0
[info    ] [PASS] Running PRISM051_DataConnectionCodegenPass0_0
[info    ] [PASS] Running PRISM052_FinalizePass0_0
[info    ] [PASS] Running PRISM053_FinalizeSnapshotPass0_0
[info    ] [PASS] Running PRISM054_VagExprCompilePass0_0
[info    ] [PASS] Running PRISM055_WatermarkPass0_0
[info    ] [PASS] Running PRISM056_OrphanUnitPass0_0
[info    ] [PASS] Running PRISM057_BoxFileGenPass0_0
[info    ] [PASS] Running PRISM058_P2pPass0_0
[info    ] [PASS] Running PRISM059_AsmIRPostPortAllocAsmTransformPass0_0
[info    ] [PASS] Running PRISM060_DataSocketAnnotationPass0_0
[info    ] [PASS] Running PRISM061_AuroraFileGenPass0_0
[info    ] [PASS] Running PRISM062_AsmLegalizerPass0_0
[info    ] [PASS] Running PRISM063_ExpectedPacketCountAnnotationPass0_0
[info    ] [PASS] Running PRISM064_ConnectionPatchPass0_0
[info    ] [PASS] Running PRISM065_AsmPlasticineCodegen0_0
[info    ] [PASS] Running PRISM066_ConnectionPatchPass0_0
[info    ] [PASS] Running PRISM067_PrintAsmPass_post_codegen0_0
[info    ] [PASS] Running PRISM068_PrintAsmPass_asm_ir_report0_0
[warning ] [../prism/src/plasma/lib/Core/Traversal/Analysis/RouteReportPass.cpp:34] Old report is not removed: /scratch/jobs/38941838/jit_out/jit_out_0_0.routes_report.txt
[info    ] [PASS] Running PRISM069_RouteReportPass0_0
[info    ] [PASS] Running PRISM070_AgcuFileGenPass0_0
[info    ] [PASS] Running PRISM071_CheckerPass0_0
[info    ] [PASS] Running PRISM072_ArgInsPass0_0
[info    ] [PASS] Running PRISM073_BitfileGenPass0_0
[info    ] bitfile /scratch/jobs/38941838/jit_out/jit_out.bin created
[info    ] [PASS] Running PRISM074_UtilizationFileGenPass0_0
[info    ] [PASS] Running PRISM075_PmuStatsPass0_0
[info    ] PMUStats: Writing /scratch/jobs/38941838/jit_out/jit_out_0_0.pmu_stat_info.csv
[info    ] PMUStats: Writing /scratch/jobs/38941838/jit_out/jit_out_0_0.pmu_stat_ctx_info.csv
[info    ] [PASS] Running PRISM076_PostProcessSectionsPass0_0
[info    ] Freeing memory for compilation phase 0__0
[info    ] Incremental Passes for Section(s) 0__0 Completed.
[info    ] Incremental Passes Completed.
[info    ] [PASS] Running PRISM077_SymInitFunctionsPass
[info    ] [PASS] Running PRISM078_DataAllocPass
[info    ] [PASS] Running PRISM079_HostFifoPass
[info    ] [PASS] Running PRISM080_HostFunctionPass
[info    ] [PASS] Running PRISM081_DebugFileGenPass
[info    ] [PASS] Running PRISM082_PefGenPass
[info    ] symbol log file /scratch/jobs/38941838/jit_out/jit_out.symbol.log created
[info    ] PEF file /scratch/jobs/38941838/jit_out/jit_out.pef created
[info    ] PEF log file /scratch/jobs/38941838/jit_out/jit_out.pef.log created
[info    ] bitfile /scratch/jobs/38941838/jit_out/jit_out.bin loaded
[info    ] bitfile /scratch/jobs/38941838/jit_out/jit_out.bin.slam created
[info    ] [PASS] Running PRISM083_DatafileGenPass
[info    ] datafile /scratch/jobs/38941838/jit_out/jit_out.data created
[info    ] Data log file /scratch/jobs/38941838/jit_out/jit_out.data.log created
[info    ] PnR node feedback file created /scratch/jobs/38941838/jit_out/jit_out.node_feedback.json
[info    ] PnR partition feedback file created /scratch/jobs/38941838/jit_out/jit_out.partition_feedback.json
[info    ] Global Passes Completed.
[arc:info] Generated debug_cpp files placed in: /scratch/jobs/38941838/jit_out/imcg_cpp/arc_gen/
[arc:info] Generated files placed in: /scratch/jobs/38941838/jit_out/arc_gen/
[arc:info] Compilation succeeded.
[mac:info] Mac Compilation succeeded.
[compiler:info] copy pef /scratch/jobs/38941838/jit_out/jit_out.pef to /scratch/jobs/38941838/jit_out/jit_out.0.pef
[compiler:info] Successfully compiled pef at /scratch/jobs/38941838/jit_out/jit_out.pef
[JITPerf] force_evaluate::CompilePEF 1141933175 ns
[JITPerf] force_evaluate::FilterInputs 40950 ns
Log ID initialized to: [surajk][python][615705] at /var/log/sambaflow/runtime/sn.log
[JITPerf] force_evaluate::Runtime 388337144 ns
[compiler:info] ============ PEF run finished and get tensors ========
[compiler:info] [torch_rdu] Copy from: 0x55fc8946edd0 to: 0x55fc8946f710
[compiler:info]   Source: 16384 bytes with name  0x55fc89307570
[compiler:info]   Dest: 16384 bytes with name  0x0
[compiler:info] [torch_rdu] div ...
[JITPerf] &JIT::construct 240 ns
[JITPerf] get_empty() 491 ns
[compiler:info] [torch_rdu] empty for size: {} ...
[JITPerf] get_rdu_tensor_impl() 140 ns
[compiler:info] Creating new IR...
[compiler:info] [torch_rdu] alias ...
[compiler:info] RDU shallow_copy_and_detach &&1 0x55fc892d1090 1 has_backanno: 0
[compiler:info] [torch_rdu] alias ...
[compiler:info] RDU shallow_copy_and_detach &&1 0x55fc893109e0 1 has_backanno: 0
[JITPerf] extract_inputs_helper() 11038796 ns
[JITPerf] &JIT::construct 60 ns
[JITPerf] get_rdu_tensor_impl() 60 ns
[JITPerf] update_ir() 1730 ns
[compiler:info] module @program attributes {arc.AIRMappingDecisionIsSpatial = false, arc.kAIRAddnOpt = true, arc.kAIRBufferBeforeConcatAddn = false, arc.kAIRBufferNonRedundancy = "", arc.kAIRDPTilingOptimization = false, arc.kAIRDisableConcatStoreOpt = false, arc.kAIRDisableLoadTilerOptWithDimOrdering = false, arc.kAIRDisableOptimizeRereadBuffer = false, arc.kAIREnableSkipBufferExtensionOpt = false, arc.kAIREnableStoreTilerOptWithDimOrdering = false, arc.kAIRForceDRAMFirstThenP2P = false, arc.kAIRMappingDecisionGlobalNumBatches = 1 : i64, arc.kAIRMetaPipeWithOneIterationRemoval = false, arc.kAIRTransposeMatMulTransformation = false, arc.kAppName = "jit_out", arc.kArchMajor = 1 : i64, arc.kArchMinor = 0 : i64, arc.kBoxLayoutSize = 2 : i64, arc.kBoxLayoutType = 0 : i64, arc.kConcisePrinting = false, arc.kDataParallelBf16StochasticRounding = false, arc.kDataParallelBf16StochasticRoundingHighStaticBatchSize = false, arc.kDataParallelBf16StochasticRoundingSeedName = "", arc.kEliminateBufferTimeout = 100 : i64, arc.kExperimentalOptimization = true, arc.kExperimentalRAILCrossEntropy = false, arc.kExperimentalRAILCrossEntropyGrad = false, arc.kGenerateReference = true, arc.kGenerateTensorboard = false, arc.kHeuristicSliceLayouts = false, arc.kHeuristicTilerLayouts = true, arc.kLayoutTimeout = 1000 : i64, arc.kLegalizeDataflow = true, arc.kLegalizeSamples = false, arc.kMaximumGroupLatencyFactor = 5.000000e-02 : f32, arc.kMoveViews = false, arc.kOptimizeDramTransfers = false, arc.kOutputFolder = "/scratch/jobs/38941838", arc.kOverrideMaxFanout = 0 : i64, arc.kPefName = "jit_out", arc.kPlasmaIncludeReadStallCycles = false, arc.kPlasmaSkipInstrumentationOnRead0 = false, arc.kPlasmaSkipInstrumentationOnRead1 = false, arc.kPlasmaStageInstrumentation = "none", arc.kPrintSrcs = [], arc.kResourceAwareBuffers = false, arc.kSambaTuneGraph = false, arc.kSkipBufferBandwidthWeight = 1 : i64, arc.kSkipBufferMaxDepth = 4096 : i64, arc.kSkipBufferMaxFanin = 8 : i64, arc.kSkipBufferPmuWeight = 1 : i64, arc.kSplitSkipBuffer = true, arc.kStrictNodeNameOrdering = true, arc.kUseTBufferEverywhere = false, arc.kVerbose = true, mac.kDisableMacTiling = false, mac.kMacDisableMappingSort = false, mac.kMacDisableRetryLowerScalingFactor = false, mac.kMacEnableBufferTrialCompile = false, mac.kMacEnableHDRetryLowerVisibleResources = false, mac.kMacEnableNodeTrialCompile = false, mac.kMacEnableNodeTrialCompileLogging = false, mac.kMacIsUnrollingFirst = false, mac.kMacMaxTilingDepth = 0 : i64, mac.kMacOnlyCompileMac = false, mac.kMacPlot = false, mac.kMacPrintMappingIR = false, mac.kMacSectionCutBeamSearch = [2, 2], mac.kMacSplitCatAsStageBuffer = false, mac.kMacTemplateDBDir = "", mac.kMacTensorParallel = "none", mac.kMacUseHostFIFO = false}  {
  module @templates  {
  }
  module @sections  {
    %0 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %1 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %2 = "air.Div"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
  }
  module @schedule  {
  }
  module @rnn_function  {
  }
}
[JITPerf] apply_binary_() 11120726 ns
[JITPerf] apply_binary() 11137847 ns
[JITPerf] &JIT::construct 50 ns
[JITPerf] &JIT::construct 30 ns
[compiler:info] [torch_rdu] mul ...
[JITPerf] &JIT::construct 30 ns
[JITPerf] get_empty() 100 ns
[compiler:info] [torch_rdu] empty for size: {} ...
[JITPerf] get_rdu_tensor_impl() 40 ns
[compiler:info] [torch_rdu] alias ...
[compiler:info] RDU shallow_copy_and_detach &&1 0x55fc87f66c80 1 has_backanno: 0
[JITPerf] extract_inputs_helper() 22811 ns
[JITPerf] &JIT::construct 51 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] &JIT::construct 31 ns
[JITPerf] &JIT::construct 30 ns
[JITPerf] get_rdu_tensor_impl() 170 ns
[JITPerf] update_ir() 1000 ns
[compiler:info] module @program attributes {arc.AIRMappingDecisionIsSpatial = false, arc.kAIRAddnOpt = true, arc.kAIRBufferBeforeConcatAddn = false, arc.kAIRBufferNonRedundancy = "", arc.kAIRDPTilingOptimization = false, arc.kAIRDisableConcatStoreOpt = false, arc.kAIRDisableLoadTilerOptWithDimOrdering = false, arc.kAIRDisableOptimizeRereadBuffer = false, arc.kAIREnableSkipBufferExtensionOpt = false, arc.kAIREnableStoreTilerOptWithDimOrdering = false, arc.kAIRForceDRAMFirstThenP2P = false, arc.kAIRMappingDecisionGlobalNumBatches = 1 : i64, arc.kAIRMetaPipeWithOneIterationRemoval = false, arc.kAIRTransposeMatMulTransformation = false, arc.kAppName = "jit_out", arc.kArchMajor = 1 : i64, arc.kArchMinor = 0 : i64, arc.kBoxLayoutSize = 2 : i64, arc.kBoxLayoutType = 0 : i64, arc.kConcisePrinting = false, arc.kDataParallelBf16StochasticRounding = false, arc.kDataParallelBf16StochasticRoundingHighStaticBatchSize = false, arc.kDataParallelBf16StochasticRoundingSeedName = "", arc.kEliminateBufferTimeout = 100 : i64, arc.kExperimentalOptimization = true, arc.kExperimentalRAILCrossEntropy = false, arc.kExperimentalRAILCrossEntropyGrad = false, arc.kGenerateReference = true, arc.kGenerateTensorboard = false, arc.kHeuristicSliceLayouts = false, arc.kHeuristicTilerLayouts = true, arc.kLayoutTimeout = 1000 : i64, arc.kLegalizeDataflow = true, arc.kLegalizeSamples = false, arc.kMaximumGroupLatencyFactor = 5.000000e-02 : f32, arc.kMoveViews = false, arc.kOptimizeDramTransfers = false, arc.kOutputFolder = "/scratch/jobs/38941838", arc.kOverrideMaxFanout = 0 : i64, arc.kPefName = "jit_out", arc.kPlasmaIncludeReadStallCycles = false, arc.kPlasmaSkipInstrumentationOnRead0 = false, arc.kPlasmaSkipInstrumentationOnRead1 = false, arc.kPlasmaStageInstrumentation = "none", arc.kPrintSrcs = [], arc.kResourceAwareBuffers = false, arc.kSambaTuneGraph = false, arc.kSkipBufferBandwidthWeight = 1 : i64, arc.kSkipBufferMaxDepth = 4096 : i64, arc.kSkipBufferMaxFanin = 8 : i64, arc.kSkipBufferPmuWeight = 1 : i64, arc.kSplitSkipBuffer = true, arc.kStrictNodeNameOrdering = true, arc.kUseTBufferEverywhere = false, arc.kVerbose = true, mac.kDisableMacTiling = false, mac.kMacDisableMappingSort = false, mac.kMacDisableRetryLowerScalingFactor = false, mac.kMacEnableBufferTrialCompile = false, mac.kMacEnableHDRetryLowerVisibleResources = false, mac.kMacEnableNodeTrialCompile = false, mac.kMacEnableNodeTrialCompileLogging = false, mac.kMacIsUnrollingFirst = false, mac.kMacMaxTilingDepth = 0 : i64, mac.kMacOnlyCompileMac = false, mac.kMacPlot = false, mac.kMacPrintMappingIR = false, mac.kMacSectionCutBeamSearch = [2, 2], mac.kMacSplitCatAsStageBuffer = false, mac.kMacTemplateDBDir = "", mac.kMacTensorParallel = "none", mac.kMacUseHostFIFO = false}  {
  module @templates  {
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0], sym_name = "mul_lambda1", type = () -> ()} : () -> ()
  }
  module @sections  {
    %0 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %1 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %2 = "air.Div"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    %3 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %4 = "air.Collect"(%2, %3) {kConfigured = true, kLambda = @mul_lambda1, kMacInfoName = "collect_default", kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
  }
  module @schedule  {
  }
  module @rnn_function  {
  }
}
[JITPerf] apply_binary_() 442622 ns
[JITPerf] apply_binary() 447232 ns
[compiler:info] [torch_rdu] mul ...
[JITPerf] &JIT::construct 40 ns
[JITPerf] get_empty() 71 ns
[compiler:info] [torch_rdu] empty for size: {} ...
[JITPerf] get_rdu_tensor_impl() 30 ns
[compiler:info] [torch_rdu] alias ...
[compiler:info] RDU shallow_copy_and_detach &&1 0x55fc892d0ec0 1 has_backanno: 0
[JITPerf] extract_inputs_helper() 19960 ns
[JITPerf] &JIT::construct 30 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] &JIT::construct 30 ns
[JITPerf] &JIT::construct 30 ns
[JITPerf] &JIT::construct 31 ns
[JITPerf] &JIT::construct 40 ns
[JITPerf] get_rdu_tensor_impl() 90 ns
[JITPerf] update_ir() 770 ns
[compiler:info] module @program attributes {arc.AIRMappingDecisionIsSpatial = false, arc.kAIRAddnOpt = true, arc.kAIRBufferBeforeConcatAddn = false, arc.kAIRBufferNonRedundancy = "", arc.kAIRDPTilingOptimization = false, arc.kAIRDisableConcatStoreOpt = false, arc.kAIRDisableLoadTilerOptWithDimOrdering = false, arc.kAIRDisableOptimizeRereadBuffer = false, arc.kAIREnableSkipBufferExtensionOpt = false, arc.kAIREnableStoreTilerOptWithDimOrdering = false, arc.kAIRForceDRAMFirstThenP2P = false, arc.kAIRMappingDecisionGlobalNumBatches = 1 : i64, arc.kAIRMetaPipeWithOneIterationRemoval = false, arc.kAIRTransposeMatMulTransformation = false, arc.kAppName = "jit_out", arc.kArchMajor = 1 : i64, arc.kArchMinor = 0 : i64, arc.kBoxLayoutSize = 2 : i64, arc.kBoxLayoutType = 0 : i64, arc.kConcisePrinting = false, arc.kDataParallelBf16StochasticRounding = false, arc.kDataParallelBf16StochasticRoundingHighStaticBatchSize = false, arc.kDataParallelBf16StochasticRoundingSeedName = "", arc.kEliminateBufferTimeout = 100 : i64, arc.kExperimentalOptimization = true, arc.kExperimentalRAILCrossEntropy = false, arc.kExperimentalRAILCrossEntropyGrad = false, arc.kGenerateReference = true, arc.kGenerateTensorboard = false, arc.kHeuristicSliceLayouts = false, arc.kHeuristicTilerLayouts = true, arc.kLayoutTimeout = 1000 : i64, arc.kLegalizeDataflow = true, arc.kLegalizeSamples = false, arc.kMaximumGroupLatencyFactor = 5.000000e-02 : f32, arc.kMoveViews = false, arc.kOptimizeDramTransfers = false, arc.kOutputFolder = "/scratch/jobs/38941838", arc.kOverrideMaxFanout = 0 : i64, arc.kPefName = "jit_out", arc.kPlasmaIncludeReadStallCycles = false, arc.kPlasmaSkipInstrumentationOnRead0 = false, arc.kPlasmaSkipInstrumentationOnRead1 = false, arc.kPlasmaStageInstrumentation = "none", arc.kPrintSrcs = [], arc.kResourceAwareBuffers = false, arc.kSambaTuneGraph = false, arc.kSkipBufferBandwidthWeight = 1 : i64, arc.kSkipBufferMaxDepth = 4096 : i64, arc.kSkipBufferMaxFanin = 8 : i64, arc.kSkipBufferPmuWeight = 1 : i64, arc.kSplitSkipBuffer = true, arc.kStrictNodeNameOrdering = true, arc.kUseTBufferEverywhere = false, arc.kVerbose = true, mac.kDisableMacTiling = false, mac.kMacDisableMappingSort = false, mac.kMacDisableRetryLowerScalingFactor = false, mac.kMacEnableBufferTrialCompile = false, mac.kMacEnableHDRetryLowerVisibleResources = false, mac.kMacEnableNodeTrialCompile = false, mac.kMacEnableNodeTrialCompileLogging = false, mac.kMacIsUnrollingFirst = false, mac.kMacMaxTilingDepth = 0 : i64, mac.kMacOnlyCompileMac = false, mac.kMacPlot = false, mac.kMacPrintMappingIR = false, mac.kMacSectionCutBeamSearch = [2, 2], mac.kMacSplitCatAsStageBuffer = false, mac.kMacTemplateDBDir = "", mac.kMacTensorParallel = "none", mac.kMacUseHostFIFO = false}  {
  module @templates  {
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0], sym_name = "mul_lambda2", type = () -> ()} : () -> ()
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0], sym_name = "mul_lambda1", type = () -> ()} : () -> ()
  }
  module @sections  {
    %0 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %1 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %2 = "air.Div"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    %3 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %4 = "air.Collect"(%2, %3) {kConfigured = true, kLambda = @mul_lambda1, kMacInfoName = "collect_default", kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    %5 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %6 = "air.Collect"(%2, %5) {kConfigured = true, kLambda = @mul_lambda2, kMacInfoName = "collect_default", kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
  }
  module @schedule  {
  }
  module @rnn_function  {
  }
}
[JITPerf] apply_binary_() 345551 ns
[JITPerf] apply_binary() 350041 ns
[JITPerf] &JIT::construct 30 ns
[JITPerf] &JIT::construct 30 ns
[compiler:info] RDU shallow_copy_and_detach &&0 0x7f798801e290 0 has_backanno: 0
[compiler:info] RDU shallow_copy_and_detach &0 0x7f7988006200 0 has_backanno: 0
[compiler:info] RDU shallow_copy_and_detach &&0 0x55fc893109e0 0 has_backanno: 0
[compiler:info] RDU shallow_copy_and_detach &0 0x7f798801e290 0 has_backanno: 0
[JITPerf] &JIT::construct 60 ns
[compiler:info] [torch_rdu] Copy from: 0x55fc8946edd0 to: 0x55fc894b76c0
[compiler:info]   Source: 16384 bytes with name  0x55fc89307570
[compiler:info]   Dest: 16384 bytes with name  0x0
[JITPerf] &JIT::construct 240 ns
[JITPerf] force_evaluate::RDUTensorImpl 550 ns
[compiler:info] Forcing evaluation...
[compiler:info] owning_ir_storage count: 2
[JITPerf] force_evaluate::PrepareIR 80230 ns
[compiler:info] module @program attributes {arc.AIRMappingDecisionIsSpatial = false, arc.kAIRAddnOpt = true, arc.kAIRBufferBeforeConcatAddn = false, arc.kAIRBufferNonRedundancy = "", arc.kAIRDPTilingOptimization = false, arc.kAIRDisableConcatStoreOpt = false, arc.kAIRDisableLoadTilerOptWithDimOrdering = false, arc.kAIRDisableOptimizeRereadBuffer = false, arc.kAIREnableSkipBufferExtensionOpt = false, arc.kAIREnableStoreTilerOptWithDimOrdering = false, arc.kAIRForceDRAMFirstThenP2P = false, arc.kAIRMappingDecisionGlobalNumBatches = 1 : i64, arc.kAIRMetaPipeWithOneIterationRemoval = false, arc.kAIRTransposeMatMulTransformation = false, arc.kAppName = "jit_out", arc.kArchMajor = 1 : i64, arc.kArchMinor = 0 : i64, arc.kBoxLayoutSize = 2 : i64, arc.kBoxLayoutType = 0 : i64, arc.kConcisePrinting = false, arc.kDataParallelBf16StochasticRounding = false, arc.kDataParallelBf16StochasticRoundingHighStaticBatchSize = false, arc.kDataParallelBf16StochasticRoundingSeedName = "", arc.kEliminateBufferTimeout = 100 : i64, arc.kExperimentalOptimization = true, arc.kExperimentalRAILCrossEntropy = false, arc.kExperimentalRAILCrossEntropyGrad = false, arc.kGenerateReference = true, arc.kGenerateTensorboard = false, arc.kHeuristicSliceLayouts = false, arc.kHeuristicTilerLayouts = true, arc.kLayoutTimeout = 1000 : i64, arc.kLegalizeDataflow = true, arc.kLegalizeSamples = false, arc.kMaximumGroupLatencyFactor = 5.000000e-02 : f32, arc.kMoveViews = false, arc.kOptimizeDramTransfers = false, arc.kOutputFolder = "/scratch/jobs/38941838", arc.kOverrideMaxFanout = 0 : i64, arc.kPefName = "jit_out", arc.kPlasmaIncludeReadStallCycles = false, arc.kPlasmaSkipInstrumentationOnRead0 = false, arc.kPlasmaSkipInstrumentationOnRead1 = false, arc.kPlasmaStageInstrumentation = "none", arc.kPrintSrcs = [], arc.kResourceAwareBuffers = false, arc.kSambaTuneGraph = false, arc.kSkipBufferBandwidthWeight = 1 : i64, arc.kSkipBufferMaxDepth = 4096 : i64, arc.kSkipBufferMaxFanin = 8 : i64, arc.kSkipBufferPmuWeight = 1 : i64, arc.kSplitSkipBuffer = true, arc.kStrictNodeNameOrdering = true, arc.kUseTBufferEverywhere = false, arc.kVerbose = true, mac.kDisableMacTiling = false, mac.kMacDisableMappingSort = false, mac.kMacDisableRetryLowerScalingFactor = false, mac.kMacEnableBufferTrialCompile = false, mac.kMacEnableHDRetryLowerVisibleResources = false, mac.kMacEnableNodeTrialCompile = false, mac.kMacEnableNodeTrialCompileLogging = false, mac.kMacIsUnrollingFirst = false, mac.kMacMaxTilingDepth = 0 : i64, mac.kMacOnlyCompileMac = false, mac.kMacPlot = false, mac.kMacPrintMappingIR = false, mac.kMacSectionCutBeamSearch = [2, 2], mac.kMacSplitCatAsStageBuffer = false, mac.kMacTemplateDBDir = "", mac.kMacTensorParallel = "none", mac.kMacUseHostFIFO = false}  {
  module @templates  {
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0], sym_name = "mul_lambda2", type = () -> ()} : () -> ()
    "air.Lambda"() ( {
      %0 = "air.lambda.input"() {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %1 = "air.lambda.input"() {kConfigured = true, kId = 1 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : () -> tensor<2x64x32xbf16>
      %2 = "air.Mul"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
      "air.lambda.output"(%2) {kConfigured = true, kId = 0 : i64, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>) -> ()
      "tlir.terminator"() {kConfigured = true, kUniqueId = 5 : i64} : () -> ()
    }) {kConfigured = true, kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0], sym_name = "mul_lambda1", type = () -> ()} : () -> ()
  }
  module @sections  {
    %0 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %1 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %2 = "air.Div"(%0, %1) {kBinaryOp = true, kConfigured = true, kNodeCategory = 2 : i64} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    %3 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %4 = "air.Collect"(%2, %3) {kConfigured = true, kLambda = @mul_lambda1, kMacInfoName = "collect_default", kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    %5 = "air.Tensor"() {kConfigured = true, kIsWeight = false, kNodeCategory = 5 : i64} : () -> tensor<2x64x32xbf16>
    %6 = "air.Collect"(%2, %5) {kConfigured = true, kLambda = @mul_lambda2, kMacInfoName = "collect_default", kNodeCategory = 2 : i64, kSplitCanBroadcast = [false, false], kSplitDegree = [2, 64], kSplitDim = [0, 1], kSplitDpChips = [[], []], kSplitIsMetapiped = [true, true], kSplitIsSqueezed = [true, true], kSplitMetapipeId = [0, 1], kSplitOperandIdx = [-1, -1], kSplitSlices = [[], []], kSplitStageId = [0, 0]} : (tensor<2x64x32xbf16>, tensor<2x64x32xbf16>) -> tensor<2x64x32xbf16>
    "air.Output"(%4) {kConfigured = true, kNodeCategory = 5 : i64} : (tensor<2x64x32xbf16>) -> ()
    "air.Output"(%6) {kConfigured = true, kNodeCategory = 5 : i64} : (tensor<2x64x32xbf16>) -> ()
  }
  module @schedule  {
  }
  module @rnn_function  {
  }
}
[JITPerf] force_evaluate::PopulateMeta 289022 ns
[compiler:info] ====== HASH INFO: bcb79a697b1bf2c0d0464da88af83c10bbe74e76483e8689ebaf77f51773ab55
[mac:warn] name collision detected for input_0
[mac:warn] name collision detected for input_1
[mac:warn] name collision detected for air_Collect_0
[mac:warn] name collision detected for air_Collect_0_unary
[mac:warn] name collision detected for air_Collect_0_binary1
[mac:warn] name collision detected for air_Output_0
[mac:warn] name collision detected for air_Output_1
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
MAC129_AIRResourceAwarePeepholeOptIter converged after 1 iteration(s)
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
MAC134_AIRToTLIRLoweringNestedLoopsIter converged after 1 iteration(s)
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
Updated RegionView start borders for 0 slice groups.
[info    ] Total per-section passes: 77
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out.s0.utilization_report.txt
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/stage_buffers/partition_latency_0_0.dot
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out_0_0_tln_traffic_report.txt
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out_0_0_bandwidth_statistics.txt
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out_0_0_bandwidth_statistics.csv
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out_0_0.node_statistics.csv
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out_0_0.detailed_pmu_statistics.csv
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out_0_0.detailed_pcu_statistics.csv
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out_0_0.template_names.csv
[info    ] Removed artifact file: /scratch/jobs/38941838/jit_out/jit_out.data
[info    ] Compiling graph for section 0
[mac:info] Building nameddims for graph jit_out
[mac:info] Analyze tiling for graph: jit_out
[mac:info] Mapping for graph jit_out
[mac:info] Set up stage ID and metapipe ID for section 0
[mac:info] MAC decided on the following section cuts for graph jit_out
[mac:info] Amortized resources overall: 3.000000e+00 PCUs, 1.800000e+01 PMUs, projected latency: 3.545876e-05 s, FLOPS: 3.465434e-04 T/s, DDR_BW: 1.290975e+00 GB/s
[mac:info] Lowering to TLIR succeeded.
[rail:info] Logs are generated in /scratch/jobs/38941838/jit_out//rail_gen//rail_compile_logs for partition_0_0_.
[rail:info] Compilation succeeded for partition_0_0_. Elapsed time:  203ms
[info    ] [PASS] Running PRISM000_PreProcessPass0_0
[info    ] Generated utilization report file: /scratch/jobs/38941838/jit_out/jit_out.s0.utilization_report.txt
[info    ] [PASS] Running PRISM001_FeedbackGenPass0_0
[info    ] [PASS] Running PRISM002_PlasmaIRPass0_0
[compiler:info] Starting Plasma compile at /scratch/jobs/38941838/jit_out/plasma_ir_modules/sections_0_0
[compiler:info] Plasma compile succeeded.
[compiler:info] Starting Plasma compile at /scratch/jobs/38941838/jit_out/plasma_ir_modules/schedule_0_0
[compiler:info] Plasma compile succeeded.
[info    ] [PASS] Running PRISM003_PlasmaIRSymbolAllocExportPass0_0
[info    ] [PASS] Running PRISM004_LegalizeUtilizationPass0_0
[info    ] [PASS] Running PRISM005_LegalizeSocketConnectionsPass0_0
[info    ] [PASS] Running PRISM006_LayoutConsolidationPass0_0
[info    ] [PASS] Running PRISM007_PmuLoadStoreSetupPass0_0
[info    ] [PASS] Running PRISM008_FinalizeIoPass0_0
[info    ] [PASS] Running PRISM009_CollectConnectionPass0_0
[info    ] [PASS] Running PRISM010_NetworkValidationPass0_0
[info    ] [PASS] Running PRISM011_DramAnalyticalReportPass0_0
[info    ] Logging dram analysis report to /scratch/jobs/38941838/jit_out/prism_gen/reports/dram_analysis.json
[info    ] [PASS] Running PRISM012_AsmIRGenPNRConnectPass0_0
[info    ] [PASS] Running PRISM013_PrintLoweringPass0_0
[info    ] [PASS] Running PRISM014_AsmIRResourceAllocationPass0_0
[info    ] [PASS] Running PRISM015_PmuExprCompilePass0_0
[info    ] [PASS] Running PRISM016_GroupAnnotationPass0_0
[info    ] [PASS] Running PRISM017_TemplateDataflowGraphPass0_0
[info    ] [PASS] Running PRISM018_BoxUtilizationLegalizerPass0_0
[info    ] [PASS] Running PRISM019_LegalizePartitionAssignmentPass0_0
[info    ] [PASS] Running PRISM020_ConditionValidationPass0_0
[info    ] [PASS] Running PRISM021_AssignMetapipeStagePass0_0
[info    ] [PASS] Running PRISM022_AnalyticalModelFileGenPass0_0
[info    ] [PASS] Running PRISM023_PlasmaIRProgramStatePass0_0
[info    ] [PASS] Running PRISM024_MetapipeStageLatencyPass0_0
[info    ] Generated metapipe stage graph dot file: /scratch/jobs/38941838/jit_out/stage_buffers/partition_latency_0_0.dot
[info    ] [PASS] Running PRISM025_MetapipeStageGraphPass0_0
[info    ] [PASS] Running PRISM026_BandwidthAnnotationPass0_0
[info    ] BandwidthAnnotationPropagation log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM026_BandwidthAnnotationPass0_0.BWP.0.0.log
[info    ] BandwidthAnnotationPropagation log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM026_BandwidthAnnotationPass0_0.BWP.0.0.log
[info    ] 

============ Bandwidth QA Report ============

Total edges: 19
Bandwidth starving edges before pass (src/sink < 0.8): 4 (21.0526%)
Bandwidth back pressure edges before pass (src/sink > 1.2): 2 (10.5263%)
Missing source bandwidth after pass: 0 (0%)
Missing sink bandwidth after pass: 0 (0%)

[info    ] [PASS] Running PRISM027_FilePlacementPass_GenEdgeId0_0
[info    ] [PASS] Running PRISM028_FloorplanPass0_0
[info    ] Floorplanning log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM028_FloorplanPass0_0.FP.0.0.log
[info    ] [PASS] Running PRISM029_VagAllocPass0_0
[info    ] [PASS] Running PRISM030_AsmIRPrePortAllocAsmTransformPass0_0
[info    ] [PASS MANAGER] Start PnR
[info    ] [PASS] Running PRISM031_PlacerPass0_0
[info    ] Prism config stored in: /scratch/jobs/38941838/jit_out/jit_out.configs
[info    ] Launching placement flow with (set) 1 threads
[info    ] BoxPlanner log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM031_PlacerPass0_0.BP.0.0.log
[info    ] WavefrontPlacer log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM031_PlacerPass0_0.DFG.0.0.log
[info    ] SAPlacer log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM031_PlacerPass0_0.SA.0.0.log
[info    ] Placement runtime:	partition{0, 0}: 1s	
[info    ] [PASS] Running PRISM032_PmuTwinPass0_0
[info    ] [PASS] Running PRISM033_TemplateTileDoneLoweringPass0_0
[info    ] [PASS] Running PRISM034_VagConfigurePass0_0
[info    ] [PASS] Running PRISM035_VagAllocReportPass0_0
[info    ] [PASS] Running PRISM036_DataPortAllocatorPass0_0
[info    ] [PASS] Running PRISM037_AgcuOrchestrationPass0_0
[info    ] [PASS] Running PRISM038_RampControlPass0_0
[info    ] [PASS] Running PRISM039_E2EInjectionPass0_0
[info    ] [PASS] Running PRISM040_InstrumentationPreprocessPass0_0
[info    ] [PASS] Running PRISM041_BarrierLoweringPass0_0
[info    ] [PASS] Running PRISM042_ControlPortAllocatorPass0_0
[info    ] [PASS] Running PRISM043_ControlBandwidthAnnotationPass0_0
[info    ] [PASS] Running PRISM044_InstrumentationCounterPass0_0
[info    ] [PASS] Running PRISM045_ControlPortAllocatorPass0_0
[info    ] [PASS] Running PRISM046_ControlConnectorPass0_0
[info    ] [PASS] Running PRISM047_DataConnectorPass0_0
[info    ] [PASS MANAGER] Done with PnR
[info    ] [PASS] Running PRISM048_BandwidthReportPass0_0
[info    ] BandwidthReport log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM048_BandwidthReportPass0_0.VECTOR.0.0.log
[info    ] BandwidthReport log for Partition{0, 0}: /scratch/jobs/38941838/jit_out/prism_gen/plasma_compile_logs/PRISM048_BandwidthReportPass0_0.SCALAR.0.0.log
[info    ] [PASS] Running PRISM049_FeedbackGenPass0_0
[info    ] [PASS] Running PRISM050_ControlConnectionCodegenPass0_0
[info    ] [PASS] Running PRISM051_DataConnectionCodegenPass0_0
[info    ] [PASS] Running PRISM052_FinalizePass0_0
[info    ] [PASS] Running PRISM053_FinalizeSnapshotPass0_0
[info    ] [PASS] Running PRISM054_VagExprCompilePass0_0
[info    ] [PASS] Running PRISM055_WatermarkPass0_0
[info    ] [PASS] Running PRISM056_OrphanUnitPass0_0
[info    ] [PASS] Running PRISM057_BoxFileGenPass0_0
[info    ] [PASS] Running PRISM058_P2pPass0_0
[info    ] [PASS] Running PRISM059_AsmIRPostPortAllocAsmTransformPass0_0
[info    ] [PASS] Running PRISM060_DataSocketAnnotationPass0_0
[info    ] [PASS] Running PRISM061_AuroraFileGenPass0_0
[info    ] [PASS] Running PRISM062_AsmLegalizerPass0_0
[info    ] [PASS] Running PRISM063_ExpectedPacketCountAnnotationPass0_0
[info    ] [PASS] Running PRISM064_ConnectionPatchPass0_0
[info    ] [PASS] Running PRISM065_AsmPlasticineCodegen0_0
[info    ] [PASS] Running PRISM066_ConnectionPatchPass0_0
[info    ] [PASS] Running PRISM067_PrintAsmPass_post_codegen0_0
[info    ] [PASS] Running PRISM068_PrintAsmPass_asm_ir_report0_0
[info    ] [PASS] Running PRISM069_RouteReportPass0_0
[info    ] [PASS] Running PRISM070_AgcuFileGenPass0_0
[info    ] [PASS] Running PRISM071_CheckerPass0_0
[info    ] [PASS] Running PRISM072_ArgInsPass0_0
[info    ] [PASS] Running PRISM073_BitfileGenPass0_0
[info    ] bitfile /scratch/jobs/38941838/jit_out/jit_out.bin created
[info    ] [PASS] Running PRISM074_UtilizationFileGenPass0_0
[info    ] [PASS] Running PRISM075_PmuStatsPass0_0
[info    ] PMUStats: Writing /scratch/jobs/38941838/jit_out/jit_out_0_0.pmu_stat_info.csv
[info    ] PMUStats: Writing /scratch/jobs/38941838/jit_out/jit_out_0_0.pmu_stat_ctx_info.csv
[info    ] [PASS] Running PRISM076_PostProcessSectionsPass0_0
[info    ] Freeing memory for compilation phase 0__0
[info    ] Incremental Passes for Section(s) 0__0 Completed.
[info    ] Incremental Passes Completed.
[info    ] [PASS] Running PRISM077_SymInitFunctionsPass
[info    ] [PASS] Running PRISM078_DataAllocPass
[info    ] [PASS] Running PRISM079_HostFifoPass
[info    ] [PASS] Running PRISM080_HostFunctionPass
[info    ] [PASS] Running PRISM081_DebugFileGenPass
[info    ] [PASS] Running PRISM082_PefGenPass
[info    ] symbol log file /scratch/jobs/38941838/jit_out/jit_out.symbol.log created
[info    ] PEF file /scratch/jobs/38941838/jit_out/jit_out.pef created
[info    ] PEF log file /scratch/jobs/38941838/jit_out/jit_out.pef.log created
[info    ] bitfile /scratch/jobs/38941838/jit_out/jit_out.bin loaded
[info    ] bitfile /scratch/jobs/38941838/jit_out/jit_out.bin.slam created
[info    ] [PASS] Running PRISM083_DatafileGenPass
[info    ] datafile /scratch/jobs/38941838/jit_out/jit_out.data created
[info    ] Data log file /scratch/jobs/38941838/jit_out/jit_out.data.log created
[info    ] PnR node feedback file created /scratch/jobs/38941838/jit_out/jit_out.node_feedback.json
[info    ] PnR partition feedback file created /scratch/jobs/38941838/jit_out/jit_out.partition_feedback.json
[info    ] Global Passes Completed.
[arc:info] Generated debug_cpp files placed in: /scratch/jobs/38941838/jit_out/imcg_cpp/arc_gen/
[arc:info] Generated files placed in: /scratch/jobs/38941838/jit_out/arc_gen/
[arc:info] Compilation succeeded.
[mac:info] Mac Compilation succeeded.
[compiler:info] copy pef /scratch/jobs/38941838/jit_out/jit_out.pef to /scratch/jobs/38941838/jit_out/jit_out.1.pef
[compiler:info] Successfully compiled pef at /scratch/jobs/38941838/jit_out/jit_out.pef
[JITPerf] force_evaluate::CompilePEF 1632169113 ns
[JITPerf] force_evaluate::FilterInputs 21510 ns
Log ID initialized to: [surajk][python][615705] at /var/log/sambaflow/runtime/sn.log
[JITPerf] force_evaluate::Runtime 364865435 ns
[compiler:info] ============ PEF run finished and get tensors ========
[compiler:info] [torch_rdu] Copy from: 0x7f798801ff80 to: 0x55fc8a00e0c0
[compiler:info]   Source: 16384 bytes with name  0x0
[compiler:info]   Dest: 16384 bytes with name  0x0
[JITPerf] &JIT::construct 200 ns
[compiler:info] [torch_rdu] Copy from: 0x7f7988006200 to: 0x55fc8a310220
[compiler:info]   Source: 16384 bytes with name  0x0
[compiler:info]   Dest: 16384 bytes with name  0x0
[JITPerf] &JIT::construct 110 ns
loss tensor([[[1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         ...,
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918]],

        [[1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         ...,
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918]]],
       grad_fn=<LogBackward0>)
loss tensor([[[1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         ...,
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891]],

        [[1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         ...,
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891]]],
       grad_fn=<ToCopyBackward0>)
CPU Elapsed time  0.0136 seconds
RDU Elapsed time  1.5740 seconds
Tensor_0: 

CPU:
tensor([[[1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         ...,
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918]],

        [[1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         ...,
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918],
         [1.7918, 1.7918, 1.7918,  ..., 1.7918, 1.7918, 1.7918]]],
       grad_fn=<LogBackward0>)

RDU:
tensor([[[1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         ...,
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891]],

        [[1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         ...,
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891],
         [1.7891, 1.7891, 1.7891,  ..., 1.7891, 1.7891, 1.7891]]],
       grad_fn=<ToCopyBackward0>)
Tensor_1: 

CPU:
tensor([[[0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         ...,
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000]],

        [[0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         ...,
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000]]])

RDU:
tensor([[[0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         ...,
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000]],

        [[0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         ...,
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000],
         [0.5000, 0.5000, 0.5000,  ..., 0.5000, 0.5000, 0.5000]]])
Tensor_2: 

CPU:
tensor([[[0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         ...,
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333]],

        [[0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         ...,
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333],
         [0.3333, 0.3333, 0.3333,  ..., 0.3333, 0.3333, 0.3333]]])

RDU:
tensor([[[0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         ...,
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340]],

        [[0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         ...,
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340],
         [0.3340, 0.3340, 0.3340,  ..., 0.3340, 0.3340, 0.3340]]])
Compile count: 2
[JITPerf] &JIT::construct 51 ns
Pef count: 2
[JITPerf] &JIT::construct 31 ns
[JITPerf] &JIT::construct 40 ns
++ cat /proc/615703/cgroup
++ grep -oP '^.*:memory:\K.*$'
+ cat /sys/fs/cgroup/memory//slurm/uid_1447851142/job_38941838/step_batch/task_0/memory.max_usage_in_bytes
+ grep --text -oP 'slurmJobId=38941838.*Physical RDU ID: \K\d+' /var/log/sambaflow/runtime/sn.log
+ true
<181>2022-07-11T00:53:06.506817-07:00 sc-s145 [surajk][python][615705]: [NOTICE][RSC][meta hostname=sc-s145.sambanovasystems.com tid=615705 slurmJobId=38941838] Resource Status: Allocation Success
<181>2022-07-11T00:53:06.584597-07:00 sc-s145 [surajk][python][615705]: [NOTICE][RSC][meta hostname=sc-s145.sambanovasystems.com tid=615705 slurmJobId=38941838] grdu_mask: 0
<181>2022-07-11T00:53:06.584715-07:00 sc-s145 [surajk][python][615705]: [NOTICE][RSC][meta hostname=sc-s145.sambanovasystems.com tid=615705 slurmJobId=38941838] Physical RDU 0
<181>2022-07-11T00:53:08.565538-07:00 sc-s145 [surajk][python][615705]: [NOTICE][RSC][meta hostname=sc-s145.sambanovasystems.com tid=615705 slurmJobId=38941838] Resource Status: Allocation Success
<181>2022-07-11T00:53:08.642863-07:00 sc-s145 [surajk][python][615705]: [NOTICE][RSC][meta hostname=sc-s145.sambanovasystems.com tid=615705 slurmJobId=38941838] grdu_mask: 0
<181>2022-07-11T00:53:08.642952-07:00 sc-s145 [surajk][python][615705]: [NOTICE][RSC][meta hostname=sc-s145.sambanovasystems.com tid=615705 slurmJobId=38941838] Physical RDU 0

SlurmJobInfo(state='COMPLETED', elapsed_string='00:00:12', elapsed_seconds=12, start_time='2022-07-11T07:52:59', exit_code=0, exit_signal=0, host='sc-s145', os='ubuntu 20.04')
